{"version":3,"sources":["components/game.tsx","components/gameList.tsx","components/app.tsx","index.tsx"],"names":["img","float","marginRight","div","display","marginBottom","inline","row","Game","props","key","game","appID","name","logoUrl","logoURL","owned","style","src","alt","_","require","getUserId","handle","a","cachedid","localStorage","getItem","JSON","parse","fetch","response","json","steamid","setItem","stringify","getGames","cachedgames","games","PopulateList","libraries","Object","keys","length","combined","forEach","library","push","unique","uniqWith","isEqual","sort","b","gameA","toUpperCase","gameB","comparison","filter","obj","some","obj2","current","test","process","output","GameList","useState","setLibraries","load","handles","getLibraries","libs","wait","Promise","resolve","reject","index","array","then","useEffect","className","margin","App","onClick","e","clear","window","location","reload","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f7e412ef.chunk.js","sourcesContent":["import React from 'react';\r\n\r\n\r\nconst img = {\r\n  float: 'left',\r\n  marginRight: '20px'\r\n} as React.CSSProperties;\r\n\r\nconst div = {\r\n  display: 'table',\r\n  marginBottom: '20px'\r\n} as React.CSSProperties;\r\n\r\nconst inline = {\r\n  display: 'inline',\r\n} as React.CSSProperties;\r\n\r\nconst row = {\r\n  display: 'table-row',\r\n} as React.CSSProperties;\r\n\r\nfunction Game(props) {\r\n\r\n  const key = props.game.appID;\r\n  const name = props.game.name;\r\n  const logoUrl = props.game.logoURL;\r\n  const owned = props.game.owned;\r\n\r\n  return (\r\n    <div style={div}>\r\n      <div style={inline}>\r\n        <h5 style={row}>{name}</h5>\r\n        <h5 style={row}>x{owned}</h5>\r\n      </div>\r\n      <img key={key} src={logoUrl} alt={name} style={img} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Game;\r\n","import React, { useState, useEffect } from 'react';\r\nimport Game from './game';\r\n\r\nvar _ = require('lodash');\r\n\r\nconst resolveUserUrl = 'https://9192zxrrp6.execute-api.eu-west-1.amazonaws.com/default/get_steamUserIdFromHandle_Function';\r\nconst gamesListUrl = 'https://k14n0rcap5.execute-api.eu-west-1.amazonaws.com/default/get_userOwnedGames_Function';\r\n\r\n\r\n\r\nconst process = (libraries) => {\r\n\r\n  if (!libraries) {\r\n    return null;\r\n  }\r\n\r\n  // combine all libraries, duplicates included\r\n  let combined: any[] = [];\r\n\r\n  const keys = Object.keys(libraries);\r\n\r\n  keys.forEach(key => {\r\n    const library = libraries[key];\r\n    combined.push(...library);\r\n  });\r\n\r\n  // get all unique games in all libraries\r\n  let unique = _.uniqWith(combined, _.isEqual);\r\n\r\n  // order the unique games\r\n  const compare = (a, b) => {\r\n    const gameA = a.name.toUpperCase();\r\n    const gameB = b.name.toUpperCase();\r\n\r\n    let comparison = 0;\r\n    if (gameA > gameB) {\r\n      comparison = 1;\r\n    } else if (gameA < gameB) {\r\n      comparison = -1;\r\n    }\r\n    return comparison;\r\n  }\r\n\r\n  unique.sort(compare);\r\n\r\n  // count how many users own each game and add a property to record it\r\n  keys.forEach(key => {\r\n\r\n    const library = libraries[key];\r\n\r\n    // find values that are in unique list and also in library\r\n    var owned = unique.filter(function(obj) {\r\n        return library.some(function(obj2) {\r\n            return obj.appID === obj2.appID;\r\n        });\r\n    });\r\n\r\n    // loop through the owned list and increase the count in the unique list\r\n    owned.forEach(game => {\r\n      const current = unique.filter(test => test.appID === game.appID)\r\n\r\n      if (current.length === 1) {\r\n        if (current[0][\"owned\"]) {\r\n          current[0][\"owned\"]++;\r\n        } else {\r\n          current[0][\"owned\"] = 1;\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  // order by number owned\r\n  const compare2 = (a, b) => {\r\n    const gameA = a.owned;\r\n    const gameB = b.owned;\r\n\r\n    let comparison = 0;\r\n    if (gameA < gameB) {\r\n      comparison = 1;\r\n    } else if (gameA > gameB) {\r\n      comparison = -1;\r\n    }\r\n    return comparison;\r\n  }\r\n\r\n  unique.sort(compare2);\r\n\r\n  // trim off games that are only owned by 1 users\r\n  const filtered = unique.filter(test => {\r\n    return test.owned > 1\r\n  });\r\n\r\n  return filtered;\r\n}\r\n\r\n\r\n\r\nconst getUserId = async (handle: string): Promise<string> => {\r\n\r\n  const key = `${handle}_steamid`;\r\n\r\n  const cachedid = localStorage.getItem(key);\r\n  if (cachedid != null && cachedid !== '')\r\n    return JSON.parse(cachedid);\r\n\r\n  const response = await fetch(`${resolveUserUrl}?handle=${handle}`);\r\n  const steamid = await response.json();\r\n\r\n  localStorage.setItem(key, JSON.stringify(steamid));\r\n\r\n  return steamid;\r\n}\r\n\r\n\r\n\r\nconst getGames = async (steamid) => {\r\n\r\n  const key = `${steamid}_games`;\r\n\r\n  const cachedgames = localStorage.getItem(key);\r\n  if (cachedgames != null && cachedgames !== '')\r\n    return JSON.parse(cachedgames);\r\n\r\n  const response = await fetch(`${gamesListUrl}?steamid=${steamid}`);\r\n  const games = await response.json();\r\n\r\n  if (games) {\r\n    localStorage.setItem(key, JSON.stringify(games));\r\n  }\r\n\r\n  return games;\r\n}\r\n\r\n\r\n\r\nfunction PopulateList(props): any {\r\n\r\n  const libraries = props.libraries;\r\n  if (!libraries || !Object.keys(libraries).length) {\r\n    return null;\r\n  }\r\n\r\n  const games = process(libraries);\r\n  if (!games || !games.length) {\r\n    return null;\r\n  }\r\n\r\n  let output: any[] = [];\r\n\r\n  games.forEach(game => {\r\n    output.push(<Game game={game} />);\r\n  });\r\n\r\n  if (output.length) {\r\n    return output;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n\r\n\r\nfunction GameList() {\r\n\r\n  const [libraries, setLibraries] = useState({});\r\n\r\n  const load = async (handles) => {\r\n\r\n    const getLibraries = async () => {\r\n\r\n      let libs = {};\r\n\r\n      var wait = new Promise((resolve, reject) => {\r\n        handles.forEach(async (handle, index, array) => {\r\n          await getUserId(handle)\r\n            .then(async steamid => {\r\n              await getGames(steamid)\r\n                .then(games => {\r\n                  if (games) {\r\n                    libs[steamid] = games;\r\n                  }\r\n                  if (index === array.length -1) resolve();\r\n                })\r\n            });\r\n        });\r\n      });\r\n\r\n      return wait.then(() => libs);\r\n    }\r\n\r\n    await getLibraries()\r\n      .then(libs => {\r\n        setLibraries(libs)\r\n      });\r\n  }\r\n\r\n  useEffect(() => {\r\n\r\n    const handles: string[] =\r\n    [\r\n      'steviedisco',\r\n      'delphboy',\r\n      'chipbarm',\r\n      'StealthBanana',\r\n      'andreas3115',\r\n    ];\r\n\r\n    load(handles)\r\n\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"section\">\r\n        { !libraries || !Object.keys(libraries).length ? <></> : <PopulateList libraries={libraries} /> }\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GameList;\r\n","import React from 'react';\nimport './../styles/app.css';\n\nimport GameList from './gameList';\n\n\nconst margin = {\n  marginBottom: '20px'\n} as React.CSSProperties;\n\n\nfunction App() {\n\n  const clearCacheHandler = e => {\n    localStorage.clear();\n    window.location.reload(false);\n  }\n\n  return (\n    <>\n      <div className=\"container\">\n        <div className=\"section\">\n          <div className=\"header\">\n            <h1>Steam Room</h1>\n          </div>\n          <pre>\n            <code className=\"prettyprint prettyprinted\">\n              Compare Steam libraries to help organise online multiplayer sessions with your friends.\n            </code>\n          </pre>\n        </div>\n        <div className=\"btn\" style={margin} onClick={clearCacheHandler}>Clear cache</div>\n      </div>\n      <GameList />\n    </>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}