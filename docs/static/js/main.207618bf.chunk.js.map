{"version":3,"sources":["library-client.ts","components/userList.tsx","components/userAdd.tsx","components/game.tsx","components/gameList.tsx","components/app.tsx","index.tsx"],"names":["_","require","getUserId","handle","a","key","cachedid","localStorage","getItem","JSON","parse","fetch","response","json","steamid","setItem","stringify","getGames","cachedgames","fetchGames","Promise","resolve","then","catch","console","log","games","fetchLibraries","handles","fetchLibrary","fetchAll","libs","resolvedCount","i","library","length","libraries","getLibraries","getSummaries","fetchSummaries","fetchSummary","reject","getProfile","summary","err","sums","summaries","cachedprofiles","fetchProfile","profile","block","display","pointer","cursor","inline","UserList","props","removeUserHandler","useState","setSummaries","useEffect","client","Object","keys","style","map","user","className","nickname","value","disabled","onClick","removeHandle","UserAdd","addUserHandler","setHandle","placeholder","onChange","e","target","img","float","marginRight","userimg","headerRow","marginBottom","imgs","users","header","Game","game","appID","owned","name","src","avatar","medium","alt","title","logoURL","PopulateList","combined","forEach","push","unique","uniqWith","isEqual","sort","b","gameA","toUpperCase","gameB","comparison","filter","obj","some","obj2","current","test","output","GameList","setLibraries","themeBar","marginTop","textAlign","alignCenter","App","setHandles","alert","includes","concat","index","indexOf","copy","splice","clear","window","location","reload","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.207618bf.chunk.js","sourcesContent":["var _ = require('lodash');\r\n\r\nconst resolveUserUrl = 'https://9192zxrrp6.execute-api.eu-west-1.amazonaws.com/default/get_steamUserIdFromHandle_Function';\r\nconst gamesListUrl = 'https://k14n0rcap5.execute-api.eu-west-1.amazonaws.com/default/get_userOwnedGames_Function';\r\nconst userSummaryUrl = 'https://8ydkm187n9.execute-api.eu-west-1.amazonaws.com/default/get_userSummary_Function';\r\n\r\n\r\nexport const process = (libraries, summaries) => {\r\n\r\n  if (!libraries || !summaries) {\r\n    return null;\r\n  }\r\n\r\n  // combine all libraries, duplicates included\r\n  let combined: any[] = [];\r\n\r\n  const keys = Object.keys(libraries);\r\n\r\n  keys.forEach(key => {\r\n    const library = libraries[key];\r\n    combined.push(...library);\r\n  });\r\n\r\n  // get all unique games in all libraries\r\n  let unique = _.uniqWith(combined, _.isEqual);\r\n\r\n  // order the unique games\r\n  const compare = (a, b) => {\r\n    const gameA = a.name.toUpperCase();\r\n    const gameB = b.name.toUpperCase();\r\n\r\n    let comparison = 0;\r\n    if (gameA > gameB) {\r\n      comparison = 1;\r\n    } else if (gameA < gameB) {\r\n      comparison = -1;\r\n    }\r\n    return comparison;\r\n  }\r\n\r\n  unique.sort(compare);\r\n\r\n  // count how many users own each game and add a property to record it\r\n  keys.forEach(key => {\r\n\r\n    const library = libraries[key];\r\n\r\n    // find values that are in unique list and also in library\r\n    var owned = unique.filter(function(obj) {\r\n        return library.some(function(obj2) {\r\n            return obj.appID === obj2.appID;\r\n        });\r\n    });\r\n\r\n    // loop through the owned list and increase the count in the unique list\r\n    owned.forEach(game => {\r\n\r\n      const current = unique.filter(test => test.appID === game.appID)\r\n\r\n      if (current.length === 1) {\r\n        if (current[0][\"owned\"]) {\r\n          current[0][\"owned\"]++;\r\n        } else {\r\n          current[0][\"owned\"] = 1;\r\n          current[0][\"users\"] = [];\r\n        }\r\n        current[0][\"users\"].push(summaries[key]);\r\n      }\r\n    });\r\n  });\r\n\r\n  // order by number owned\r\n  const compare2 = (a, b) => {\r\n    const gameA = a.owned;\r\n    const gameB = b.owned;\r\n\r\n    let comparison = 0;\r\n    if (gameA < gameB) {\r\n      comparison = 1;\r\n    } else if (gameA > gameB) {\r\n      comparison = -1;\r\n    }\r\n    return comparison;\r\n  }\r\n\r\n  unique.sort(compare2);\r\n\r\n  // trim off games that are only owned by 1 users\r\n  const filtered = unique.filter(test => {\r\n    return test.owned > 1\r\n  });\r\n\r\n  return filtered;\r\n}\r\n\r\n\r\n\r\nconst getUserId = async (handle: string): Promise<string> => {\r\n\r\n  const key = `${handle}_steamid`;\r\n\r\n  const cachedid = localStorage.getItem(key);\r\n  if (cachedid != null && cachedid !== '')\r\n    return JSON.parse(cachedid);\r\n\r\n  const response = await fetch(`${resolveUserUrl}?handle=${handle}`);\r\n  const steamid = await response.json();\r\n\r\n  localStorage.setItem(key, JSON.stringify(steamid));\r\n\r\n  return steamid;\r\n}\r\n\r\n\r\n\r\nconst getGames = async (steamid) => {\r\n\r\n  const key = `${steamid}_games`;\r\n\r\n  const cachedgames = localStorage.getItem(key);\r\n  if (cachedgames != null && cachedgames !== '')\r\n    return JSON.parse(cachedgames);\r\n\r\n  const fetchGames = (steamid) => {\r\n    return new Promise((resolve) => {\r\n      (async () => {\r\n        await fetch(`${gamesListUrl}?steamid=${steamid}`)\r\n          .then(response => response.json())\r\n          .then(response => {\r\n            resolve(response)\r\n          })\r\n          .catch(() => {\r\n            console.log(\"Game list fetch failed\");\r\n            resolve(null);\r\n          });\r\n        })();\r\n      });\r\n  };\r\n\r\n  const games = await fetchGames(steamid);\r\n\r\n  if (games) {\r\n    localStorage.setItem(key, JSON.stringify(games));\r\n  }\r\n\r\n  return games;\r\n}\r\n\r\n\r\nconst fetchLibraries = async (handles) => {\r\n\r\n  const fetchLibrary = (handle) => {\r\n    return new Promise((resolve) => {\r\n      (async () => {\r\n        await getUserId(handle)\r\n          .then(async steamid => {\r\n            await getGames(steamid)\r\n              .then(games => {\r\n                  resolve(games);\r\n              })\r\n          });\r\n        })();\r\n      });\r\n  };\r\n\r\n  const fetchAll = () => {\r\n\r\n    return new Promise((resolve) => {\r\n\r\n      (async () => {\r\n        let libs = {};\r\n        let resolvedCount = 0;\r\n\r\n        for (let i = 0; i < handles.length; i++) {\r\n\r\n          const handle = handles[i];\r\n\r\n          await (async () => {\r\n            const library = await fetchLibrary(handle);\r\n\r\n            if (library) {\r\n              libs[handle] = library;\r\n            }\r\n          })();\r\n\r\n          resolvedCount++;\r\n          if (resolvedCount === handles.length) {\r\n            resolve(libs);\r\n          }\r\n      }})();\r\n    });\r\n  };\r\n\r\n  const libraries = await fetchAll();\r\n  return libraries;\r\n};\r\n\r\n\r\nexport const getLibraries = async (handles) => {\r\n  return await fetchLibraries(handles);\r\n};\r\n\r\n\r\nexport const getSummaries = async (handles) => {\r\n  return await fetchSummaries(handles);\r\n};\r\n\r\n\r\nexport const fetchSummary = (handle) => {\r\n  return new Promise((resolve, reject) => {\r\n    (async () => {\r\n      await getUserId(handle)\r\n        .then(async steamid => {\r\n          await getProfile(steamid)\r\n            .then(summary => {\r\n                resolve(summary);\r\n            })\r\n            .catch(err => resolve(null));\r\n        })\r\n        .catch(err => resolve(null));\r\n      })();\r\n    });\r\n};\r\n\r\n\r\nconst fetchSummaries = async (handles) => {\r\n\r\n  const fetchAll = () => {\r\n\r\n    return new Promise((resolve) => {\r\n\r\n      (async () => {\r\n        let sums = {};\r\n        let resolvedCount = 0;\r\n\r\n        for (let i = 0; i < handles.length; i++) {\r\n\r\n          const handle = handles[i];\r\n\r\n          await (async () => {\r\n            const summary = await fetchSummary(handle);\r\n\r\n            if (summary) {\r\n              sums[handle] = summary;\r\n            }\r\n          })();\r\n\r\n          resolvedCount++;\r\n          if (resolvedCount === handles.length) {\r\n            resolve(sums);\r\n          }\r\n      }})();\r\n    });\r\n  };\r\n\r\n  const summaries = await fetchAll();\r\n  return summaries;\r\n};\r\n\r\n\r\nconst getProfile = async (steamid) => {\r\n\r\n  const key = `${steamid}_profile`;\r\n\r\n  const cachedprofiles = localStorage.getItem(key);\r\n  if (cachedprofiles != null && cachedprofiles !== '')\r\n    return JSON.parse(cachedprofiles);\r\n\r\n  const fetchProfile = (steamid) => {\r\n    return new Promise((resolve) => {\r\n      (async () => {\r\n        await fetch(`${userSummaryUrl}?steamid=${steamid}`)\r\n          .then(response => response.json())\r\n          .then(response => {\r\n            resolve(response)\r\n          })\r\n          .catch(() => {\r\n            console.log(\"User profile fetch failed\");\r\n            resolve(null);\r\n          });\r\n        })();\r\n      });\r\n  };\r\n\r\n  const profile = await fetchProfile(steamid);\r\n\r\n  if (profile) {\r\n    localStorage.setItem(key, JSON.stringify(profile));\r\n  }\r\n\r\n  return profile;\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\n\r\nimport * as client from './../library-client';\r\n\r\n\r\n\r\nconst block = {\r\n  display: 'block',\r\n} as React.CSSProperties;\r\n\r\nconst pointer = {\r\n  cursor: 'pointer'\r\n} as React.CSSProperties;\r\n\r\nconst inline = {\r\n  display: 'inline',\r\n} as React.CSSProperties;\r\n\r\n\r\nfunction UserList(props) {\r\n\r\n  let { handles, removeUserHandler } = props;\r\n\r\n  const [summaries, setSummaries] = useState({} as any);\r\n\r\n  useEffect(() => {\r\n\r\n    client.getSummaries(handles)\r\n      .then(sums => {\r\n        setSummaries(sums)\r\n      });\r\n\r\n  }, [handles]);\r\n\r\n  const removeHandle = handle => {\r\n    removeUserHandler(handle);\r\n  }\r\n\r\n  if (!Object.keys(summaries)) {\r\n    return null;\r\n  }\r\n\r\n  return (<div style={block}>\r\n    {\r\n      handles.map(handle => {\r\n        const user = summaries[handle];\r\n        if (user) {\r\n          return (<>\r\n            <div style={block}>\r\n              <i className=\"inputIcon material-icons\">face</i>\r\n              <input key={`user_${user.nickname}`} className=\"inputIcon\" value={user.nickname} disabled={true} />\r\n              <div style={inline}>\r\n                <i className=\"inputIcon material-icons\" style={pointer} onClick={() => removeHandle(user.nickname)}>remove_circle</i>\r\n              </div>\r\n            </div>\r\n            </>\r\n          );\r\n        }\r\n\r\n        return <></>;\r\n      })\r\n    }\r\n  </div>);\r\n}\r\n\r\nexport default UserList;\r\n","import React, { useState } from 'react';\r\n\r\nconst block = {\r\n  display: 'block',\r\n} as React.CSSProperties;\r\n\r\nconst inline = {\r\n  display: 'inline',\r\n} as React.CSSProperties;\r\n\r\nconst pointer = {\r\n  cursor: 'pointer'\r\n} as React.CSSProperties;\r\n\r\n\r\n\r\nfunction UserAdd(props) {\r\n\r\n  let { addUserHandler } = props;\r\n\r\n  const [handle, setHandle] = useState('');\r\n\r\n  const addHandle = e => {\r\n    addUserHandler(handle);\r\n    setHandle('');\r\n  }\r\n\r\n  const handleChange = e => {\r\n    setHandle(e.target.value);\r\n  }\r\n\r\n  return (\r\n    <div style={block}>\r\n      <div style={inline}>\r\n        <i className=\"inputIcon material-icons\">face</i>\r\n        <input className=\"inputIcon\" placeholder=\"Add Steam User\" value={handle} onChange={handleChange} />\r\n      </div>\r\n      <div style={inline}>\r\n        <i className=\"inputIcon material-icons\" style={pointer} onClick={addHandle}>add_circle</i>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UserAdd;\r\n","import React from 'react';\r\n\r\n\r\nconst img = {\r\n  float: 'left',\r\n  marginRight: '20px'\r\n} as React.CSSProperties;\r\n\r\nconst userimg = {\r\n  marginRight: '10px'\r\n} as React.CSSProperties;\r\n\r\nconst headerRow = {\r\n  display: 'table',\r\n  marginBottom: '10px'\r\n} as React.CSSProperties;\r\n\r\nconst imgs = {\r\n  display: 'table',\r\n  marginBottom: '30px'\r\n} as React.CSSProperties;\r\n\r\nconst users = {\r\n  display: 'inline-block',\r\n} as React.CSSProperties;\r\n\r\nconst header = {\r\n  display: 'inline',\r\n} as React.CSSProperties;\r\n\r\n\r\nfunction Game(props) {\r\n\r\n  let { game } = props;\r\n  const key = `img_${game.appID}`;\r\n\r\n  return (\r\n    <>\r\n    <div style={headerRow}>\r\n      <h5 style={header}>x{game.owned} {game.name}</h5>\r\n    </div>\r\n    <div style={imgs}>\r\n      <div style={users}>\r\n        { game.users.map(user => <img key={`${key}_${user.nickname}`} src={user.avatar.medium} alt={user.nickname} title={user.nickname} style={userimg} />) }\r\n      </div>\r\n      <img key={key} src={game.logoURL} alt={game.name} style={img} />\r\n    </div></>\r\n  );\r\n}\r\n\r\nexport default Game;\r\n","import React, { useState, useEffect } from 'react';\r\nimport Game from './game';\r\n\r\nimport * as client from './../library-client';\r\n\r\n\r\n\r\nfunction PopulateList(props): any {\r\n\r\n  let { handles, libraries, summaries } = props;\r\n\r\n  if (!libraries) {\r\n    console.log(\"Libraries empty\");\r\n    return null;\r\n  } else {\r\n    const keys = Object.keys(libraries);\r\n    if (!keys.length) {\r\n      console.log(\"Libraries empty\");\r\n      return null;\r\n    }\r\n  }\r\n\r\n  if (!summaries) {\r\n    console.log(\"Summaries empty\");\r\n    return null;\r\n  } else {\r\n    const keys = Object.keys(summaries);\r\n    if (!keys.length) {\r\n      console.log(\"Summaries empty\");\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // hack-tastic, to get round async updates\r\n  if (!(handles.length === Object.keys(libraries).length &&  Object.keys(libraries).length === Object.keys(summaries).length)) {\r\n    return null;\r\n  }\r\n\r\n  const games = client.process(libraries, summaries);\r\n  if (!games || !games.length) {\r\n    console.log(\"Games empty\");\r\n    return null;\r\n  }\r\n\r\n  let output: any[] = [];\r\n\r\n  games.forEach(game => {\r\n    const key = `game_${game.appID}`;\r\n    output.push(<Game key={key} game={game} />);\r\n  });\r\n\r\n  if (output.length) {\r\n    return output;\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n\r\n\r\n\r\n\r\nfunction GameList(props) {\r\n\r\n  let { handles } = props;\r\n\r\n  const [libraries, setLibraries] = useState({} as any);\r\n  const [summaries, setSummaries] = useState({} as any);\r\n\r\n  useEffect(() => {\r\n\r\n    /*\r\n    const handles: string[] =\r\n    [\r\n      'steviedisco',\r\n      'delphboy',\r\n      'chipbarm',\r\n      'StealthBanana',\r\n      'andreas3115',\r\n    ];\r\n    */\r\n\r\n    client.getLibraries(handles)\r\n      .then(libs => {\r\n        setLibraries(libs)\r\n      });\r\n\r\n    client.getSummaries(handles)\r\n      .then(sums => {\r\n        setSummaries(sums)\r\n      });\r\n\r\n  }, [handles]);\r\n\r\n\r\n\r\n  if (handles.length < 2) {\r\n    return null;\r\n  }\r\n\r\n\r\n  return (\r\n    <div>\r\n      <h4>Matched Games</h4>\r\n      <PopulateList handles={handles} libraries={libraries} summaries={summaries} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GameList;\r\n","import React, { useState } from 'react';\nimport './../styles/app.css';\n\nimport UserList from './userList';\nimport UserAdd from './userAdd';\nimport GameList from './gameList';\n\nimport * as client from './../library-client';\n\n\nconst themeBar = {\n  display: 'block',\n  marginTop: '20px',\n  textAlign: 'right'\n} as React.CSSProperties;\n\nconst marginBottom = {\n  marginBottom: '60px'\n} as React.CSSProperties;\n\nconst alignCenter = {\n  textAlign: 'center'\n} as React.CSSProperties;\n\n\nfunction App() {\n\n  const [handles, setHandles] = useState([] as string[]);\n\n  const clearCacheHandler = () => {\n    localStorage.clear();\n    window.location.reload(false);\n  }\n\n  const addUserHandler = async (handle) => {\n\n    if (handle === '') {\n      alert(\"Please enter a Steam username\");\n      return;\n    }\n\n    if (!handles.includes(handle)) {\n\n      await (async () => {\n        const summary = await client.fetchSummary(handle);\n\n        if (summary) {\n          setHandles(handles.concat(handle));\n        } else {\n          alert(\"User not found\");\n          return;\n        }\n      })();\n    }\n  };\n\n  const removeUserHandler = async (handle) => {\n\n    if (handle === '') {\n      alert(\"Username not provided\");\n      return;\n    }\n\n    const index = handles.indexOf(handle);\n    if (index > -1) {\n      const copy = handles.splice(0);\n      copy.splice(index, 1);\n      setHandles(copy);\n    } else {\n      alert(\"User not found\");\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"btns row themeSelector\" style={themeBar}></div>\n      <div className=\"section\">\n        <div className=\"header\">\n          <h2>Steam Room</h2>\n        </div>\n        <div className=\"body\">\n          <p style={{ ...alignCenter, ...marginBottom }}>\n            Compare Steam libraries to help organise online multiplayer sessions with your friends.\n          </p>\n        </div>\n      </div>\n      <div className=\"section\">\n        <div className=\"body\">\n          <UserList handles={handles} removeUserHandler={removeUserHandler} />\n          <UserAdd addUserHandler={addUserHandler} />\n          <div className=\"btn\" style={marginBottom} onClick={clearCacheHandler}>Clear cache</div>\n        </div>\n      </div>\n      <div className=\"section\">\n        <div className=\"body\">\n          <GameList handles={handles} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/app';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}